<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <title>意见征集 - AI业委会</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        'primary-light': '#4080FF',
                        'primary-dark': '#0F4CD3',
                        secondary: '#2D5CF6',
                        accent: '#00B96B',
                        neutral: '#F5F7FA',
                        'neutral-light': '#FAFBFC',
                        dark: '#1D2129',
                        light: '#86909C',
                        border: '#E5E6EB',
                        success: '#00B96B',
                        warning: '#FF7D00',
                        purple: '#8B5CF6',
                    }
                }
            }
        }
    </script>
    <style>
        .tab-item {
            position: relative;
            padding-bottom: 0.5rem;
        }
        .tab-item.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: #165DFF;
            border-radius: 3px 3px 0 0;
        }
    </style>
</head>
<body class="bg-neutral-light">
    <!-- 头部 -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="flex items-center justify-between px-4 py-3">
            <button onclick="history.back()" class="w-8 h-8 flex items-center justify-center">
                <i class="fa fa-arrow-left text-dark text-lg"></i>
            </button>
            <h1 class="text-lg font-bold text-dark">意见征集</h1>
            <button onclick="showPublishModal()" class="text-primary text-sm font-medium">
                <i class="fa fa-plus"></i> 发起
            </button>
        </div>
    </header>

    <!-- 标签页 -->
    <div class="bg-white border-b border-border sticky top-[52px] z-40">
        <div class="flex px-4">
            <button class="tab-item active flex-1 py-3 text-center text-sm font-medium text-primary" onclick="switchTab('ongoing')">
                进行中 <span class="inline-block w-5 h-5 bg-primary/10 text-primary rounded-full text-xs leading-5 ml-1">2</span>
            </button>
            <button class="tab-item flex-1 py-3 text-center text-sm font-medium text-light" onclick="switchTab('completed')">
                已结束 <span class="inline-block w-5 h-5 bg-gray-100 text-light rounded-full text-xs leading-5 ml-1">5</span>
            </button>
        </div>
    </div>

    <!-- 主内容 -->
    <main class="container mx-auto px-4 py-4 pb-20">
        <!-- AI智能分析提示 -->
        <div class="bg-gradient-to-r from-green-50 to-blue-50 rounded-xl p-4 mb-4">
            <div class="flex items-start gap-3">
                <div class="w-10 h-10 rounded-full bg-success text-white flex items-center justify-center flex-shrink-0">
                    <i class="fa fa-bar-chart"></i>
                </div>
                <div class="flex-1">
                    <h3 class="text-sm font-bold text-dark mb-1">AI智能分析</h3>
                    <p class="text-xs text-light">我会自动分析归类业主反馈，生成可视化统计报告，帮您快速了解业主关注的重点问题。</p>
                </div>
            </div>
        </div>

        <!-- 进行中的征集 -->
        <div id="ongoing-surveys" class="space-y-4">
            <!-- 征集1 -->
            <div class="bg-white rounded-xl p-4 shadow-sm">
                <div class="flex items-start justify-between mb-3">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="text-xs bg-primary/10 text-primary px-2 py-1 rounded-full font-medium">
                                <i class="fa fa-clock-o"></i> 进行中
                            </span>
                            <span class="text-xs text-light">还剩 5 天</span>
                        </div>
                        <h3 class="text-base font-bold text-dark mb-1">2026年小区改造项目意见征集</h3>
                        <p class="text-xs text-light">发起时间：2025-12-01 | 截止时间：2025-12-15</p>
                    </div>
                </div>

                <div class="bg-neutral-light rounded-lg p-3 mb-3">
                    <p class="text-sm text-dark mb-2">征集说明：</p>
                    <p class="text-xs text-light leading-relaxed">
                        为改善小区居住环境，业委会计划开展小区改造项目。现征集业主意见，包括但不限于：停车位改造、绿化提升、公共设施更新等。
                    </p>
                </div>

                <div class="grid grid-cols-3 gap-3 mb-3 text-center text-xs">
                    <div class="bg-primary/5 rounded-lg p-2">
                        <p class="text-light mb-1">参与人数</p>
                        <p class="text-lg font-bold text-primary">286</p>
                    </div>
                    <div class="bg-success/5 rounded-lg p-2">
                        <p class="text-light mb-1">意见数量</p>
                        <p class="text-lg font-bold text-success">428</p>
                    </div>
                    <div class="bg-warning/5 rounded-lg p-2">
                        <p class="text-light mb-1">参与率</p>
                        <p class="text-lg font-bold text-warning">33%</p>
                    </div>
                </div>

                <div class="flex gap-2">
                    <button onclick="viewAnalysis(1)" class="flex-1 text-xs text-primary border border-primary/30 rounded px-3 py-2 hover:bg-primary/5">
                        <i class="fa fa-bar-chart"></i> AI分析
                    </button>
                    <button onclick="submitOpinion(1)" class="flex-1 text-xs text-white bg-primary rounded px-3 py-2 hover:bg-primary-dark">
                        <i class="fa fa-edit"></i> 提交意见
                    </button>
                </div>
            </div>

            <!-- 征集2 -->
            <div class="bg-white rounded-xl p-4 shadow-sm">
                <div class="flex items-start justify-between mb-3">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="text-xs bg-primary/10 text-primary px-2 py-1 rounded-full font-medium">
                                <i class="fa fa-clock-o"></i> 进行中
                            </span>
                            <span class="text-xs text-light">还剩 10 天</span>
                        </div>
                        <h3 class="text-base font-bold text-dark mb-1">物业服务满意度调查</h3>
                        <p class="text-xs text-light">发起时间：2025-11-28 | 截止时间：2025-12-20</p>
                    </div>
                </div>

                <div class="bg-neutral-light rounded-lg p-3 mb-3">
                    <p class="text-sm text-dark mb-2">征集说明：</p>
                    <p class="text-xs text-light leading-relaxed">
                        为提升物业服务质量，现开展满意度调查。请对保洁、安保、维修、绿化等方面提出您的意见和建议。
                    </p>
                </div>

                <div class="grid grid-cols-3 gap-3 mb-3 text-center text-xs">
                    <div class="bg-primary/5 rounded-lg p-2">
                        <p class="text-light mb-1">参与人数</p>
                        <p class="text-lg font-bold text-primary">512</p>
                    </div>
                    <div class="bg-success/5 rounded-lg p-2">
                        <p class="text-light mb-1">意见数量</p>
                        <p class="text-lg font-bold text-success">698</p>
                    </div>
                    <div class="bg-warning/5 rounded-lg p-2">
                        <p class="text-light mb-1">参与率</p>
                        <p class="text-lg font-bold text-warning">60%</p>
                    </div>
                </div>

                <div class="flex gap-2">
                    <button onclick="viewAnalysis(2)" class="flex-1 text-xs text-primary border border-primary/30 rounded px-3 py-2 hover:bg-primary/5">
                        <i class="fa fa-bar-chart"></i> AI分析
                    </button>
                    <button onclick="submitOpinion(2)" class="flex-1 text-xs text-white bg-primary rounded px-3 py-2 hover:bg-primary-dark">
                        <i class="fa fa-edit"></i> 提交意见
                    </button>
                </div>
            </div>
        </div>

        <!-- 已结束的征集 -->
        <div id="completed-surveys" class="space-y-4 hidden">
            <!-- 完成征集1 -->
            <div class="bg-white rounded-xl p-4 shadow-sm">
                <div class="flex items-start justify-between mb-3">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="text-xs bg-gray-100 text-light px-2 py-1 rounded-full font-medium">
                                <i class="fa fa-check-circle-o"></i> 已结束
                            </span>
                        </div>
                        <h3 class="text-base font-bold text-dark mb-1">2025年度物业费标准调整意见</h3>
                        <p class="text-xs text-light">发起时间：2025-10-01 | 结束时间：2025-10-31</p>
                    </div>
                </div>

                <div class="grid grid-cols-3 gap-3 mb-3 text-center text-xs">
                    <div class="bg-primary/5 rounded-lg p-2">
                        <p class="text-light mb-1">参与人数</p>
                        <p class="text-lg font-bold text-primary">678</p>
                    </div>
                    <div class="bg-success/5 rounded-lg p-2">
                        <p class="text-light mb-1">意见数量</p>
                        <p class="text-lg font-bold text-success">892</p>
                    </div>
                    <div class="bg-warning/5 rounded-lg p-2">
                        <p class="text-light mb-1">参与率</p>
                        <p class="text-lg font-bold text-warning">79%</p>
                    </div>
                </div>

                <button onclick="viewResult(1)" class="w-full text-xs text-dark border border-border rounded px-3 py-2 hover:bg-neutral">
                    <i class="fa fa-bar-chart"></i> 查看结果报告
                </button>
            </div>
        </div>
    </main>

    <!-- AI分析弹窗 -->
    <div id="analysis-modal" class="fixed inset-0 bg-black/50 z-50 hidden">
        <div class="absolute inset-x-0 bottom-0 bg-white rounded-t-2xl max-h-[85vh] overflow-y-auto">
            <div class="sticky top-0 bg-white border-b border-border p-4 flex items-center justify-between z-10">
                <h3 class="text-lg font-bold text-dark">AI智能分析</h3>
                <button onclick="closeAnalysisModal()" class="w-8 h-8 flex items-center justify-center text-light hover:text-dark">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>

            <div class="p-4" id="analysis-content">
                <!-- 动态内容 -->
            </div>
        </div>
    </div>

    <!-- 结果报告弹窗 -->
    <div id="result-modal" class="fixed inset-0 bg-black/50 z-50 hidden">
        <div class="absolute inset-x-0 bottom-0 bg-white rounded-t-2xl max-h-[85vh] overflow-y-auto">
            <div class="sticky top-0 bg-white border-b border-border p-4 flex items-center justify-between z-10">
                <h3 class="text-lg font-bold text-dark">结果报告</h3>
                <button onclick="closeResultModal()" class="w-8 h-8 flex items-center justify-center text-light hover:text-dark">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>

            <div class="p-4" id="result-content">
                <!-- 动态内容 -->
            </div>
        </div>
    </div>

    <script>
        function switchTab(tab) {
            document.querySelectorAll('.tab-item').forEach(item => {
                item.classList.remove('active', 'text-primary');
                item.classList.add('text-light');
            });
            event.target.classList.add('active', 'text-primary');
            event.target.classList.remove('text-light');

            if (tab === 'ongoing') {
                document.getElementById('ongoing-surveys').classList.remove('hidden');
                document.getElementById('completed-surveys').classList.add('hidden');
            } else {
                document.getElementById('ongoing-surveys').classList.add('hidden');
                document.getElementById('completed-surveys').classList.remove('hidden');
            }
        }

        function showPublishModal() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-xl p-4 max-w-md w-full max-h-[80vh] overflow-y-auto">
                    <h3 class="text-lg font-bold text-dark mb-4">发起意见征集</h3>

                    <div class="space-y-3 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-dark mb-2">征集主题 <span class="text-red-500">*</span></label>
                            <input type="text" placeholder="请输入征集主题" class="w-full border border-border rounded-lg px-3 py-2 text-sm">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-dark mb-2">征集说明 <span class="text-red-500">*</span></label>
                            <textarea rows="4" placeholder="请详细说明本次征集的目的和内容..." class="w-full border border-border rounded-lg px-3 py-2 text-sm resize-none"></textarea>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-dark mb-2">截止时间 <span class="text-red-500">*</span></label>
                            <input type="date" class="w-full border border-border rounded-lg px-3 py-2 text-sm">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-dark mb-2">征集范围</label>
                            <div class="space-y-2">
                                <label class="flex items-center p-2 border border-border rounded-lg cursor-pointer">
                                    <input type="radio" name="range" value="all" checked class="mr-2">
                                    <span class="text-sm">全体业主</span>
                                </label>
                                <label class="flex items-center p-2 border border-border rounded-lg cursor-pointer">
                                    <input type="radio" name="range" value="custom" class="mr-2">
                                    <span class="text-sm">自定义范围</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="flex gap-2">
                        <button onclick="this.closest('.fixed').remove()" class="flex-1 border border-border text-dark py-2.5 rounded-lg">
                            取消
                        </button>
                        <button onclick="publishSurvey()" class="flex-1 bg-primary text-white py-2.5 rounded-lg">
                            发起征集
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function publishSurvey() {
            document.querySelector('.fixed.flex').remove();

            const loading = document.createElement('div');
            loading.className = 'fixed inset-0 bg-black/50 flex items-center justify-center z-50';
            loading.innerHTML = `
                <div class="bg-white rounded-xl p-6 m-4 text-center">
                    <div class="w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
                    <p class="text-dark font-medium">正在发起征集...</p>
                </div>
            `;
            document.body.appendChild(loading);

            setTimeout(() => {
                loading.remove();
                const success = document.createElement('div');
                success.className = 'fixed inset-0 bg-black/50 flex items-center justify-center z-50';
                success.innerHTML = `
                    <div class="bg-white rounded-xl p-6 m-4 text-center max-w-sm">
                        <div class="w-16 h-16 bg-success/10 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fa fa-check text-success text-3xl"></i>
                        </div>
                        <h3 class="text-lg font-bold text-dark mb-2">发起成功</h3>
                        <p class="text-sm text-light mb-4">意见征集已发布，业主可开始提交意见</p>
                        <button onclick="location.reload()" class="w-full bg-primary text-white py-2.5 rounded-lg">
                            确定
                        </button>
                    </div>
                `;
                document.body.appendChild(success);
            }, 1500);
        }

        function submitOpinion(id) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-xl p-4 max-w-md w-full">
                    <h3 class="text-lg font-bold text-dark mb-4">提交意见</h3>

                    <div class="space-y-3 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-dark mb-2">您的意见 <span class="text-red-500">*</span></label>
                            <textarea rows="5" placeholder="请输入您的意见和建议..." class="w-full border border-border rounded-lg px-3 py-2 text-sm resize-none"></textarea>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-dark mb-2">上传图片（选填）</label>
                            <button class="w-full border border-dashed border-border rounded-lg py-3 text-sm text-light hover:border-primary hover:text-primary">
                                <i class="fa fa-camera"></i> 点击上传图片
                            </button>
                        </div>

                        <div>
                            <label class="flex items-center">
                                <input type="checkbox" class="mr-2">
                                <span class="text-xs text-light">允许公开显示（匿名）</span>
                            </label>
                        </div>
                    </div>

                    <div class="flex gap-2">
                        <button onclick="this.closest('.fixed').remove()" class="flex-1 border border-border text-dark py-2.5 rounded-lg">
                            取消
                        </button>
                        <button onclick="submitOpinionConfirm()" class="flex-1 bg-primary text-white py-2.5 rounded-lg">
                            提交
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function submitOpinionConfirm() {
            document.querySelector('.fixed.flex').remove();
            alert('意见已提交，感谢您的参与！');
        }

        function viewAnalysis(id) {
            const analysisData = {
                1: {
                    title: '2026年小区改造项目意见征集',
                    topIssues: [
                        { name: '停车位不足', count: 156, percent: 36 },
                        { name: '绿化需要提升', count: 98, percent: 23 },
                        { name: '公共设施老化', count: 87, percent: 20 },
                        { name: '安防系统升级', count: 54, percent: 13 },
                        { name: '其他', count: 33, percent: 8 }
                    ],
                    keywords: ['停车位', '绿化', '监控', '电梯', '健身器材', '充电桩'],
                    sentiment: { positive: 45, neutral: 38, negative: 17 }
                },
                2: {
                    title: '物业服务满意度调查',
                    topIssues: [
                        { name: '保洁服务', count: 245, percent: 35 },
                        { name: '安保管理', count: 189, percent: 27 },
                        { name: '维修响应', count: 134, percent: 19 },
                        { name: '绿化养护', count: 89, percent: 13 },
                        { name: '其他', count: 41, percent: 6 }
                    ],
                    keywords: ['及时性', '服务态度', '专业性', '卫生', '安全'],
                    sentiment: { positive: 62, neutral: 28, negative: 10 }
                }
            };

            const data = analysisData[id];

            const content = `
                <div class="space-y-4">
                    <!-- 征集标题 -->
                    <div class="bg-primary/5 rounded-lg p-3">
                        <h4 class="text-sm font-bold text-dark">${data.title}</h4>
                    </div>

                    <!-- 问题分类统计 -->
                    <div>
                        <p class="text-sm font-bold text-dark mb-3 flex items-center gap-2">
                            <i class="fa fa-pie-chart text-primary"></i>
                            问题分类统计
                        </p>
                        <div class="space-y-2">
                            ${data.topIssues.map((issue, index) => `
                                <div>
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-xs text-dark">${index + 1}. ${issue.name}</span>
                                        <span class="text-xs font-bold text-primary">${issue.count}条 (${issue.percent}%)</span>
                                    </div>
                                    <div class="h-2 bg-gray-100 rounded-full overflow-hidden">
                                        <div class="h-full bg-gradient-to-r from-primary to-primary-light rounded-full" style="width: ${issue.percent}%"></div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- 高频关键词 -->
                    <div>
                        <p class="text-sm font-bold text-dark mb-3 flex items-center gap-2">
                            <i class="fa fa-tag text-success"></i>
                            高频关键词
                        </p>
                        <div class="flex flex-wrap gap-2">
                            ${data.keywords.map(keyword => `
                                <span class="px-3 py-1.5 bg-success/10 text-success rounded-full text-xs font-medium">
                                    ${keyword}
                                </span>
                            `).join('')}
                        </div>
                    </div>

                    <!-- 情感倾向分析 -->
                    <div>
                        <p class="text-sm font-bold text-dark mb-3 flex items-center gap-2">
                            <i class="fa fa-smile-o text-warning"></i>
                            情感倾向分析
                        </p>
                        <div class="space-y-2">
                            <div class="flex items-center gap-3">
                                <span class="text-xs text-dark w-12">正面</span>
                                <div class="flex-1 h-6 bg-gray-100 rounded-full overflow-hidden">
                                    <div class="h-full bg-gradient-to-r from-success to-green-400 rounded-full flex items-center justify-end pr-2" style="width: ${data.sentiment.positive}%">
                                        <span class="text-xs text-white font-bold">${data.sentiment.positive}%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <span class="text-xs text-dark w-12">中性</span>
                                <div class="flex-1 h-6 bg-gray-100 rounded-full overflow-hidden">
                                    <div class="h-full bg-gradient-to-r from-warning to-yellow-400 rounded-full flex items-center justify-end pr-2" style="width: ${data.sentiment.neutral}%">
                                        <span class="text-xs text-white font-bold">${data.sentiment.neutral}%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <span class="text-xs text-dark w-12">负面</span>
                                <div class="flex-1 h-6 bg-gray-100 rounded-full overflow-hidden">
                                    <div class="h-full bg-gradient-to-r from-red-500 to-red-400 rounded-full flex items-center justify-end pr-2" style="width: ${data.sentiment.negative}%">
                                        <span class="text-xs text-white font-bold">${data.sentiment.negative}%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- AI建议 -->
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                        <p class="text-xs font-bold text-dark mb-2 flex items-center gap-1">
                            <i class="fa fa-lightbulb-o text-primary"></i>
                            AI建议
                        </p>
                        <p class="text-xs text-dark leading-relaxed">
                            根据意见分析，建议优先解决停车位不足问题，可考虑优化现有车位布局或增建立体停车库。同时加强绿化养护，定期修剪和补种。
                        </p>
                    </div>

                    <button onclick="closeAnalysisModal()" class="w-full bg-primary text-white py-2.5 rounded-lg">
                        知道了
                    </button>
                </div>
            `;

            document.getElementById('analysis-content').innerHTML = content;
            document.getElementById('analysis-modal').classList.remove('hidden');
        }

        function closeAnalysisModal() {
            document.getElementById('analysis-modal').classList.add('hidden');
        }

        function closeResultModal() {
            document.getElementById('result-modal').classList.add('hidden');
        }

        function viewResult(id) {
            const resultData = {
                1: {
                    title: '2025年度物业费标准调整意见',
                    startDate: '2025-10-01',
                    endDate: '2025-10-31',
                    participants: 678,
                    opinions: 892,
                    participationRate: 79,
                    summary: '本次意见征集共收到678位业主参与，征集意见892条。经AI智能分析，79%的业主支持适度调整物业费标准，主要诉求集中在提升服务质量、增加公共设施维护等方面。',
                    mainIssues: [
                        { name: '支持适度上调', count: 536, percent: 60, type: 'positive' },
                        { name: '要求提升服务', count: 213, percent: 24, type: 'neutral' },
                        { name: '反对上调', count: 89, percent: 10, type: 'negative' },
                        { name: '建议分级收费', count: 54, percent: 6, type: 'neutral' }
                    ],
                    keywords: ['服务质量', '价格合理', '透明度', '保洁频次', '安保力度', '维修响应'],
                    suggestions: [
                        '建议将物业费从2.3元/平米调整至2.6元/平米',
                        '增加保洁人员,提高公共区域清洁频次',
                        '加强安保巡逻,增设监控设备',
                        '建立物业费使用公示制度,提高透明度',
                        '优化维修响应机制,承诺2小时内响应'
                    ],
                    votingResult: '根据业主意见,业委会已将物业费调整方案提交业主大会表决,最终以75.3%的赞成率通过。',
                    implementation: '新标准已于2025-11-01起正式执行,物业公司同步启动服务提升计划。'
                }
            };

            const data = resultData[id];
            if (!data) {
                alert('暂无该报告数据');
                return;
            }

            const content = `
                <div class="space-y-4">
                    <!-- 征集概况 -->
                    <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-4">
                        <h4 class="text-base font-bold text-dark mb-3">${data.title}</h4>
                        <div class="grid grid-cols-2 gap-3 text-center">
                            <div class="bg-white rounded-lg p-3">
                                <p class="text-xs text-light mb-1">参与人数</p>
                                <p class="text-xl font-bold text-primary">${data.participants}</p>
                            </div>
                            <div class="bg-white rounded-lg p-3">
                                <p class="text-xs text-light mb-1">意见数量</p>
                                <p class="text-xl font-bold text-success">${data.opinions}</p>
                            </div>
                            <div class="bg-white rounded-lg p-3">
                                <p class="text-xs text-light mb-1">参与率</p>
                                <p class="text-xl font-bold text-warning">${data.participationRate}%</p>
                            </div>
                            <div class="bg-white rounded-lg p-3">
                                <p class="text-xs text-light mb-1">征集时长</p>
                                <p class="text-xl font-bold text-purple">30天</p>
                            </div>
                        </div>
                        <div class="mt-3 pt-3 border-t border-white/50 text-xs text-light">
                            <p>征集时间: ${data.startDate} 至 ${data.endDate}</p>
                        </div>
                    </div>

                    <!-- AI分析摘要 -->
                    <div>
                        <h4 class="text-sm font-bold text-dark mb-2 flex items-center gap-2">
                            <i class="fa fa-file-text-o text-primary"></i>
                            分析摘要
                        </h4>
                        <div class="bg-neutral-light rounded-lg p-3">
                            <p class="text-xs text-dark leading-relaxed">${data.summary}</p>
                        </div>
                    </div>

                    <!-- 意见分类统计 -->
                    <div>
                        <h4 class="text-sm font-bold text-dark mb-3 flex items-center gap-2">
                            <i class="fa fa-pie-chart text-primary"></i>
                            意见分类统计
                        </h4>
                        <div class="space-y-2">
                            ${data.mainIssues.map((issue, index) => {
                                let barColor = 'from-primary to-primary-light';
                                let textColor = 'text-primary';
                                if (issue.type === 'positive') {
                                    barColor = 'from-success to-green-400';
                                    textColor = 'text-success';
                                } else if (issue.type === 'negative') {
                                    barColor = 'from-red-500 to-red-400';
                                    textColor = 'text-red-600';
                                } else {
                                    barColor = 'from-warning to-yellow-400';
                                    textColor = 'text-warning';
                                }

                                return `
                                    <div>
                                        <div class="flex justify-between items-center mb-1">
                                            <span class="text-xs text-dark">${index + 1}. ${issue.name}</span>
                                            <span class="text-xs font-bold ${textColor}">${issue.count}条 (${issue.percent}%)</span>
                                        </div>
                                        <div class="h-2 bg-gray-100 rounded-full overflow-hidden">
                                            <div class="h-full bg-gradient-to-r ${barColor} rounded-full" style="width: ${issue.percent}%"></div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>

                    <!-- 高频关键词 -->
                    <div>
                        <h4 class="text-sm font-bold text-dark mb-3 flex items-center gap-2">
                            <i class="fa fa-tags text-success"></i>
                            高频关键词
                        </h4>
                        <div class="flex flex-wrap gap-2">
                            ${data.keywords.map((keyword, index) => {
                                const colors = [
                                    'bg-primary/10 text-primary',
                                    'bg-success/10 text-success',
                                    'bg-warning/10 text-warning',
                                    'bg-purple/10 text-purple',
                                    'bg-blue-500/10 text-blue-600',
                                    'bg-pink-500/10 text-pink-600'
                                ];
                                return `
                                    <span class="px-3 py-1.5 ${colors[index % colors.length]} rounded-full text-xs font-medium">
                                        ${keyword}
                                    </span>
                                `;
                            }).join('')}
                        </div>
                    </div>

                    <!-- AI建议 -->
                    <div>
                        <h4 class="text-sm font-bold text-dark mb-3 flex items-center gap-2">
                            <i class="fa fa-lightbulb-o text-warning"></i>
                            AI综合建议
                        </h4>
                        <div class="space-y-2">
                            ${data.suggestions.map((suggestion, index) => `
                                <div class="flex items-start gap-2 p-3 bg-blue-50 rounded-lg">
                                    <span class="flex-shrink-0 w-5 h-5 bg-primary text-white rounded-full text-xs flex items-center justify-center font-bold">${index + 1}</span>
                                    <p class="text-xs text-dark flex-1 leading-relaxed">${suggestion}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- 表决结果 -->
                    <div>
                        <h4 class="text-sm font-bold text-dark mb-2 flex items-center gap-2">
                            <i class="fa fa-check-square-o text-success"></i>
                            表决结果
                        </h4>
                        <div class="bg-success/5 border border-success/20 rounded-lg p-3">
                            <p class="text-xs text-dark leading-relaxed mb-2">${data.votingResult}</p>
                            <div class="pt-2 border-t border-success/20">
                                <p class="text-xs text-success font-medium">
                                    <i class="fa fa-check-circle"></i> ${data.implementation}
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- 操作按钮 -->
                    <div class="flex gap-2 pt-2">
                        <button onclick="downloadReport(${id})" class="flex-1 border border-primary text-primary py-2.5 rounded-lg hover:bg-primary/5 font-medium">
                            <i class="fa fa-download"></i> 下载报告
                        </button>
                        <button onclick="closeResultModal()" class="flex-1 bg-primary text-white py-2.5 rounded-lg hover:bg-primary-dark font-medium">
                            关闭
                        </button>
                    </div>
                </div>
            `;

            document.getElementById('result-content').innerHTML = content;
            document.getElementById('result-modal').classList.remove('hidden');
        }

        function downloadReport(id) {
            alert('下载报告 - ID: ' + id);
        }
    </script>
</body>
</html>
